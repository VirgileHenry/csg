Second attempt at csg, this time trying to be more versatile.